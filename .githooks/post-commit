#!/bin/bash

# Get list of Python files changed in the last commit
changed_files=$(git diff --name-only HEAD~1 HEAD | grep '\.py$')

# If there are Python file changes
if [ -n "$changed_files" ]; then
    echo "Detected Python file changes. Running Bandit..."

    # Run Bandit recursively and output to CSV
    bandit -r . -f csv -o security_report.csv

    echo "Security report saved to security_report.csv"
else
    echo "No Python file changes detected. Skipping Bandit scan."
fi
